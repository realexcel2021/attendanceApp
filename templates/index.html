<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title> Attendance Form </title>
</head>
<body>
   <div class="app">
    <h1>Attendance Form</h1>
    <form>
        <input id="input-text" type="text" placeholder="Enter Student First Name" required/>
        <input id="input-text-1" type="text" placeholder="Enter Student Last Name" required/>
        <input id="input-text-2" type="text" placeholder="Enter Student Matriculation Number" required/>

        <label>select student's gender</label>
        <select id="gender">
            <option>Male</option>
            <option>Female</option>
        </select>

        <label>Is student absent?</label>
        <input type="checkbox" class="absent" id="absent">

        <button type="button" id="form"> Submit Form </button>
    </form>
    <script src="{{ url_for('static', filename='index.js') }}"></script>
   </div>
</body>
<script>
    const theForm = document.getElementById("form")
    var fname = document.getElementById("input-text")
    var lName = document.getElementById("input-text-1")
    var matricNum = document.getElementById("input-text-2")
    var gender = document.getElementById("gender")
    var absent = document.querySelector(".absent").checked

    const data = {
        first_name : fname.value,
        last_name : lName.value,
        matric_num : matricNum.value,
        gender : gender.value,
        status : absent
    }

    const jsonData = JSON.stringify(data);

    function validate() {
        let status = true
        if(fname.value == ''){
            fname.style.borderColor = 'red'
            status = false
        }
        if( lName.value == ''){
            lName.style.borderColor = 'red'
            status = false
        }
        if(matricNum.value == ''){
            matricNum.style.borderColor = 'red'
            status = false
        }
        console.log(absent)
        return status
    }

    theForm.addEventListener("click", (event) => {
        event.preventDefault();
        fetch('/people', {
            method: 'POST',
            body: jsonData,
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(() => console.log(jsonData))
        .then(response => response.json())
        .then(data => console.log(data))
        if (validate()){
            document.getElementById("names").innerText = fname.value + " " + lName.value;
            document.getElementById("matric").innerText = matricNum.value;
            document.getElementById("genderText").innerText = gender.value;
            document.getElementById("absentText").innerText = absent ? 0 : 1;
        }
    })
</script>
</html>
